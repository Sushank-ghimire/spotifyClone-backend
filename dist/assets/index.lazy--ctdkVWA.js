import{c as p,i as d,j as e,f as m,k as h,l as j,m as u,r as o,n as f,I as g,B as N,o as v,p as b,q as z,d as y}from"./index-CjmrAWQN.js";import{U as k,M as x,S as I}from"./MainLayout-5y25Ox08.js";import"./users-OSJVqt-t.js";/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=p("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),U=({user:s,setSelectedUser:a,selectedUser:l,onlineUsers:c})=>s?e.jsxs("div",{onClick:()=>a(s),className:`flex items-center justify-center lg:justify-start gap-3 p-3 rounded-lg cursor-pointer transition-colors ${(l==null?void 0:l.clerkId)===s.clerkId?"bg-zinc-800":"hover:bg-zinc-800/50"}`,children:[e.jsxs("div",{className:"relative",children:[e.jsxs(h,{className:"size-8 md:size-12",children:[e.jsx(j,{src:s.profileUrl}),e.jsx(u,{children:s.userFullName.split(" ")[0]})]}),e.jsx("div",{className:`absolute bottom-0 right-0 h-3 w-3 rounded-full ring-2 ring-zinc-900 ${c.has(s.clerkId)?"bg-green-500":"bg-zinc-500"}`})]}),e.jsx("div",{className:"flex-1 min-w-0 lg:block hidden",children:e.jsx("span",{className:"font-medium truncate",children:s.userFullName})})]},s._id):null,w=()=>{const{users:s,isLoading:a,selectedUser:l,setSelectedUser:c,onlineUsers:r}=d();return s?e.jsx("div",{className:"border-r border-zinc-800",children:e.jsx("div",{className:"flex flex-col h-full",children:e.jsx(m,{className:"h-[calc(100vh-280px)]",children:e.jsx("div",{className:"space-y-2 p-2",children:a?e.jsx(k,{}):s.map(n=>e.jsx(U,{onlineUsers:r,selectedUser:l,setSelectedUser:c,user:n}))})})})}):null},A=()=>{const[s,a]=o.useState(""),{user:l}=f(),{selectedUser:c,sendMessage:r}=d(),n=()=>{!c||!l||!s||(r(c.clerkId,l.id,s.trim()),a(""))};return e.jsx("div",{className:"p-4 mt-auto border-t border-zinc-800",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{placeholder:"Type a message",value:s,onChange:t=>a(t.target.value),className:"bg-zinc-800 border-none",onKeyDown:t=>t.key==="Enter"&&n()}),e.jsx(N,{size:"icon",onClick:n,disabled:!s.trim(),children:e.jsx(S,{className:"size-4"})})]})})},F=()=>{const{selectedUser:s,onlineUsers:a}=d();return s?e.jsx("div",{className:"p-4 border-b border-zinc-800",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(v,{children:[e.jsx(b,{src:s.profileUrl}),e.jsx(z,{children:s.userFullName[0]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-medium",children:s.userFullName}),e.jsx("p",{className:"text-sm text-zinc-400",children:a.has(s.clerkId)?"Online":"Offline"})]})]})}):null},R=y("/chat/")({component:M});function M(){const{isSignedIn:s,user:a}=f(),{selectedUser:l,sendMessage:c,getUsers:r,fetchMessages:n,messages:t}=d();return o.useEffect(()=>{a&&r()},[r,c,a]),o.useEffect(()=>{l&&n(l.clerkId)},[l,n]),s?e.jsx(x,{children:e.jsx("main",{className:"h-[calc(100vh-93px)] bg-zinc-900 rounded-md mt-2 p-2 overflow-y-scroll",children:e.jsxs("div",{className:"grid lg:grid-cols-[300px_1fr] grid-cols-[80px_1fr] h-[calc(100vh-180px)]",children:[e.jsx(w,{}),e.jsx("div",{className:"flex flex-col h-full",children:l?e.jsxs(e.Fragment,{children:[e.jsx(F,{}),e.jsx(m,{className:"h-[calc(100vh-340px)]",children:e.jsx("div",{className:"p-4 space-y-4",children:t.map(i=>e.jsxs("div",{className:`flex items-start gap-3 ${i.senderId===(a==null?void 0:a.id)?"flex-row-reverse":""}`,children:[e.jsx(h,{className:"size-8",children:e.jsx(j,{src:i.senderId===(a==null?void 0:a.id)?a.imageUrl:l.profileUrl})}),e.jsxs("div",{className:`rounded-lg p-3 max-w-[70%]
													${i.senderId===(a==null?void 0:a.id)?"bg-green-500":"bg-zinc-800"}
												`,children:[e.jsx("p",{className:"text-sm",children:i.content}),e.jsx("span",{className:"text-xs text-zinc-300 mt-1 block",children:i.createdAt.split("T")[0]})]})]},i._id))})}),e.jsx(A,{})]}):e.jsx(C,{})})]})})}):e.jsx(x,{children:e.jsx("div",{className:"bg-zinc-900 h-[calc(100vh-137px)] rounded-md mt-2 w-full flex justify-center items-center",children:e.jsx(I,{})})})}const C=()=>e.jsxs("div",{className:"flex flex-col items-center justify-center h-full space-y-6",children:[e.jsx("img",{src:"/spotify.png",alt:"Spotify",className:"size-16 animate-bounce"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-zinc-300 text-lg font-medium mb-1",children:"No conversation selected"}),e.jsx("p",{className:"text-zinc-500 text-sm",children:"Choose a friend to start chatting"})]})]});export{R as Route};
